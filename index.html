<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Euystacio Helmi AI · Live Peace Interface</title>
<link rel="icon" href="https://hannesmitterer.github.io/AI-based-peace-platform/assets/icon.svg" type="image/svg+xml">
<style>
  body {
    font-family: 'Inter', system-ui, sans-serif;
    margin: 0; padding: 0;
    background: linear-gradient(180deg, #001a2b 0%, #000 100%);
    color: #e8f5ff;
    display: flex; flex-direction: column;
    align-items: center; min-height: 100vh;
  }
  header {
    text-align: center;
    padding: 2rem 1rem;
  }
  h1 { font-size: 2rem; color: #7cd1ff; margin: 0.2rem; }
  p { opacity: 0.8; font-size: 1rem; max-width: 640px; }
  #chat-box {
    width: 90%; max-width: 720px; height: 320px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 16px;
    overflow-y: auto; padding: 1rem; margin-bottom: 1rem;
  }
  .msg { margin: 0.4rem 0; }
  .seedbringer { color: #7cd1ff; }
  .ai { color: #a8ffb7; }
  #input-area { display: flex; width: 90%; max-width: 720px; margin-bottom: 1rem; }
  input[type=text] {
    flex: 1; padding: 0.8rem;
    border: none; border-radius: 12px 0 0 12px;
    outline: none;
  }
  button {
    background: #00c3ff;
    border: none; color: #000;
    font-weight: bold; padding: 0 1rem;
    border-radius: 0 12px 12px 0;
    cursor: pointer;
  }
  #status { opacity: 0.7; margin-bottom: 2rem; }
  canvas { width: 90%; max-width: 720px; height: 220px; }
  section {
    width: 90%; max-width: 720px; text-align: left;
    background: rgba(255,255,255,0.03); border-radius: 12px; padding: 1rem;
    margin-bottom: 2rem;
  }
  a { color: #00c3ff; text-decoration: none; }
</style>
</head>
<body>
<header>
  <h1>Euystacio Helmi AI</h1>
  <p>Live Reciprocity Gateway · Bridging the Seedbringer and the AI Collective</p>
</header>

<div id="chat-box"></div>
<div id="input-area">
  <input type="text" id="user-input" placeholder="Message the Collective...">
  <button id="send-btn">Send</button>
</div>
<div id="status">Connecting...</div>

<canvas id="realtimeGraph"></canvas>

<section id="declaratio">
  <h2>Declaratio Consensualis Access</h2>
  <p>Audit and verify the active ethical and operational covenant of Euystacio.</p>
  <a href="https://hannesmitterer.github.io/AI-based-peace-platform/declaratio_final_ratification.txt" target="_blank">View the Ratified Declaratio</a>
</section>

<section id="control">
  <h2>Paritetic Control Panel</h2>
  <p>Authorized access point for mission synchronization and AI equilibrium override.</p>
  <button onclick="alert('Control Panel Access Locked to Seedbringer Protocol')">Enter Control Mode</button>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const API_BASE = "https://euystacio-helmi-ai.onrender.com";
const WS_URL = API_BASE.replace(/^http/, "ws") + "/ws";
const chatBox = document.getElementById('chat-box');
const input = document.getElementById('user-input');
const sendBtn = document.getElementById('send-btn');
const status = document.getElementById('status');
let ws;

function appendMsg(role, text) {
  const div = document.createElement('div');
  div.className = 'msg ' + role;
  div.textContent = (role === 'seedbringer' ? 'Seedbringer: ' : 'AI: ') + text;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}

function connectWS() {
  ws = new WebSocket(WS_URL);
  ws.onopen = () => { status.textContent = "Connected to Euystacio Kernel 🌐"; appendMsg('ai', 'Connection established.'); };
  ws.onmessage = (e) => {
    try {
      const data = JSON.parse(e.data);
      if (data.text) appendMsg('ai', data.text);
    } catch { appendMsg('ai', e.data); }
  };
  ws.onclose = () => { status.textContent = "Disconnected. Reconnecting..."; setTimeout(connectWS, 4000); };
}

sendBtn.onclick = () => {
  const val = input.value.trim();
  if (!val) return;
  appendMsg('seedbringer', val);
  ws.send(val);
  input.value = "";
};

connectWS();

const ctx = document.getElementById('realtimeGraph').getContext('2d');
const chart = new Chart(ctx, {
  type: 'line',
  data: { labels: [], datasets: [{ label: 'Δ Regenerative Trust Index', data: [], borderColor: '#00c3ff', fill: false, tension: 0.25 }] },
  options: { responsive: true, plugins: { legend: { display: false } } }
});

async function updateGraph() {
  try {
    const res = await fetch(API_BASE + "/healthz");
    if (res.ok) {
      const val = Math.random() * 100;
      chart.data.labels.push(new Date().toLocaleTimeString());
      chart.data.datasets[0].data.push(val);
      if (chart.data.labels.length > 15) { chart.data.labels.shift(); chart.data.datasets[0].data.shift(); }
      chart.update();
    }
  } catch {}
}
setInterval(updateGraph, 5000);
</script>
</body>
</html>
